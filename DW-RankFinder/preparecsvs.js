const { MongoClient } = require("mongodb");
const { convert } = require("html-to-text");

const { uri, contest } = require("./env");
const dbName = "DAppWorld";
const client = new MongoClient(uri);
const database = client.db(dbName);
const Papa = require('papaparse');
const fs = require('fs');
const path = require("path");
const papa = require("papaparse");



async function getUserIds(){
    const filePath = path.join(
        __dirname,
        "..",
        "data",
        "DW",
        "all_players.csv"
    );

    let results = await new Promise((resolve, reject) => {
        fs.readFile(filePath, "utf8", async (err, data) => {
            if (err) {
                console.error("Error reading the file:", err.message);
                return;
            }

            let results = papa.parse(data, {
                header: true,
                dynamicTyping: true,
            }).data;

            resolve(results);
        });
    });

    let useridsbefore = []
    let useridsduring = []


    for(data of results){
        if(data.last_contest_index == contest - 1){
            useridsduring.push(data.handle)
        }else{
            useridsbefore.push(data.handle)
        }
    }

    return {useridsbefore,useridsduring}
}


const useridsduring = [
    'H5KDz42LHHUHMJ4aAVx9BSYvPBh2',
    '5oZIjrSuBfWYD8OmK5IUw6MhUgU2',
    '4EjD0VpnSaN6nQ1mCgYc34hP4zI2',
    'JsjNzoroDQTbH9W042l8xZ478kB2',
    'Erq8sPQmkVdjbvAcPFgZrLNO3X03',
    'eSE66xB0QCOVTaRvBffRNhaOVwz2',
    '7s0bpWKAUNgnzPs6OiYNRRVFFPX2',
    'SYIwmpQWDxNOe7gZvtkjy32V7ir1',
    'tDxVv0FS5MOYcljWevBsNJbOIsg2',
    'IA3x1vGKi2YUHYEu1hvHwfIKNXG3',
    'IoFLyLUdAgUBTEG0yz9ASlW33zm2',
    'wZdEoGtxoFWBZzvIgaaoH1rFvgx1',
    'PTVYlSiC3wYT8e6PMa3ypq5Tutr2',
    'Sx51AhPLywRmgD59FCaYFLYVc5s2',
    'dhSns9sExjbOE4XkURyDrKO80tV2',
    '8RYcy1YJLCTTBPwxcvRyE8v9uCB2',
    'VY0Nc2UZk9WN6CinBbZVwsr4xMY2',
    'mw8wISeDIBf7NWO9lTfC4ru6txS2',
    'xPJq921QgZXcMC7SfLxiYiPON393',
    'i7l3jyuQCoYm1nnCHdrzwqwpAxE3',
    'urjlSdiSbyV2ai3neVXVaUPn9iA3',
    '35bZq4i7iUZXwAwpaHU1yZwza2D2',
    'XaQ1qvOuAoYSwNy9HU90K8rYqRy2',
    'H9NBnb0fdIRQQFrzkQp3vut7zBz1',
    'riLU2ku7YJUtrWytdE0Xx0QaAzI2',
    'dxAvT1VJ50MMCTZ3usmoufkja2D3',
    'TtYlpuc5SggSiSqyI2P2kztRV2y1',
    'o5F8roaiELOg4oS3FEbmqAG8DFt2',
    'GRnOubzLd2QOwibUcXQOoO075802',
    'MbVEHm6gYshDmUgYNWHQSVapR4y2',
    '7vFeOPORfqNUac3CZlGuGi0jeTq2',
    'QHYauvIiLIO5VxqZjLLNwKTcYy32',
    'uWBoni7TQZb7Tyk3bdvlhuVb38f1',
    'zmGZlq9uzveM4lmT5ZGpHWyF2i22',
    'b8UkYKfWb7WDj9MEQzbpeTDNYIL2',
    'hWHcIOnisSeJO9WK47saSf1uMgw1',
    'ynRVxjtFuqQu8uvVFRAeQu2Je9g1',
    'OOH6Li6ltoUe47UUsWHtm26Kad63',
    'MauIK0t39xVYmLKqhHm6wwMTKFH2',
    '4JCIUfaDQ5c5Td0SDoxhKkrnCqp1',
    'qccxNUSerlYiX2mGx1JE18ngCM62',
    'PjY8jNHQBCa2qdvfPm9D4IOy2dy1',
    'YiANVA3DWkcQz7lSzAqMkymRvl02',
    'YwxANYGDEjMOiTJx72bsBShitJF3',
    'WFnmy4NZ0dQjc6oo2pMJTa0Xow82',
    'OoZSGeEciwaSenDWDL2GvaM1rc22',
    'NMFxIodHpiQ41OY0XU91fWkpLzu1',
    'R5wCIZDXEthGrwPPhqLHDpu26hE2',
    'BDMRYVWQKnQ4swuT1CA7OxD4Uun2',
    'ob9gIKRPsLe47fbU5ON6qe3ipkN2',
    'UuVnftd25pUl3xWqzTFPIvXt0Jl1',
    'JHyxwCojnQTnUriUiRtSWPBDquk2',
    'yGjxqEubKqecgo0TN5vCy7Ds5qK2',
    'hKt6LreMILMhrLOZv6voOj1i1iB2',
    'IvJ23YJmBiearYNuk3n9pilzyCc2',
    'IyOvgI24f8NR5lEuJ5jkGcv3dWU2',
    '44Zvb1ghWTUYNhDvShEQrkI12N53',
    'hzprAL1XHocwkX1Li9lSZSb86le2',
    'xteO4xDsKUUn2THt6RGibjO4FI32',
    '0o9ReCyP7nTq6vnrSR9xJE3aStA3',
    '8udlhT2qVsN1UAMbqgVSZIwr2d23',
    'tWvm6xC5BHV1gkUMQQXYwk25nvW2',
    'Gh20huiz32batkdTVTKvt10cwtz1',
    'dBLdb4Jg8dhDbUAqpGsxqheD7yk2',
    'qE6S5kwDE2fsHSV696zVRq7Ctm02',
    '6MLdjRJ3YTfdZrRM7KgV3WafO832',
    'QLcWniowbeScihO4GXONlW3h3Jk2',
    'aPE7ywyIW9Zedw8QYIr5coXwD1y1',
    'yKfmtr32BpaQWOhmfgjThDlEDS93',
    'GcHUz79F6eXhRRBx1aROc3AqPui1',
    'pcZu5wPJLLezZs7XrNqV9tvMcAk1',
    'jgIqdg1jekMYQNaLLj7MiVDuYHS2',
    'j3VyW1JPEzgJ4Chnd5FP5RkeRVN2',
    'nrqrMVAolcgwsmyVjCpnew8QZIx1',
    '8DdeMcMRE9RzF7bKrIlo1NkFwsU2',
    'CIhG7lydpdaK3LIvc941nT7favx1',
    'XA1mbZtJYpgea0b3IzkgpUQw4t03',
    'Po9AAFkBJrft1euihyOEmzGB1A23',
    'DG6g0jPlL5QZaqeWk7lgUu5acnJ2',
    '2gelzILzClPKXFL15LOGkGeR0vd2',
    'aRyCyT9U2HXVdExbEqsIl0nf7nB2',
    'w8NN5Pf5uZVVl4NM1kg96wjrUc62',
    'RfmeCSeuKZSW1JFvkxWg9VIZaaU2',
    '3us7fz0Vn2OiY4KJVADfklz9EQG3',
    'wqGuomql8qdMgG26YJSLLXKlWFb2',
    '3VcvD9s0YPULXogJN5eW9Yxjm922',
    'ZljW9cDj9tTPTO5FE10UGL39eW03',
    'hrY5xtwCHdNaCwiXpU5PT4Mq4Tz2',
    'RP6RgcZfVMMkSwpX8VIOswJXE1w2',
    'TR4ZaPKRMATvd1yBYmUh5QIjmeC3',
    'SMUb0CasLKZSIYl6HjzuQWhU6t62',
    'CY4kaEYdfReXCwZfdjSBNaKpbKw2',
    '9oEEmiPSf2OioXnfJHhvgHZO42T2',
    'kEZr1WICqDejkWRAslnHNk6nfCm2',
    'ACSzlMnTlHgxtVGxD2bqm0QX9yC2',
    'WHluodv8R3P8WGV1rdMsUguRgMz1',
    'NynUCmuwWRayGz3EskEbQmOeAXu1',
    'uWZ5DfOlTJbOgbKyyWGAxCzykYg2',
    'xgy86Kvh2KMqqNoTsC63yEQITQI2',
    'X61XInnVNbfBru7Zc25t7pHKyeU2',
    'sJ5cKxBgycVrX24LwAOFPU55KL63',
    'yDvATD1KUWPlFmMMWJJ7sYxnTqc2',
    '84cpL2bkzxZVizFGiRrN5fALKSA2',
    'snYdfMmJuTS1WlFHETMhdR24BTn2',
    'Ao1Q10VcD7hbaiEFhUaRK3Kyrjr2',
    'fq2F9sHB5vMFGgedvdUMtkurkvd2',
    'khFjTovgz6SAybe96hXLT5PVX7t1',
    'HjzsRK6YtFaRJrecFd1QyQTPhgE2',
    'IIUAq1P4G3W5fTbzexr5JCc7bVQ2',
    'KiHrrJsil5U1jgPuYQsJ6pzrNkL2',
    'cfCrbkCLWac6Sd6TaZ88bhPSqP73',
    '40ie2Q3OqBejaSFvnKtE12Q8DFU2',
    '8sqGvT6NgrXE6kfniZkLvcBAYLU2',
    'jDQX1D3vU5csAJhIYBGVERe6DeB2',
    'u2dI9ZFZEDO5R1TrV8mAkZKLW0X2',
    '0ARdrqfoG5YjnpZXnf8di7B3DA82',
    'CCTq2vd44vQh7P7SWypQJ8F0hj33',
    'ISN92xJRvodaEbRon49kNmzXdwY2',
    'AU356LIn71RjPtfFy8TGfErWZlx2',
    '1GRS2WRgsXdm5wmCOG48pengiRt1',
    'DawjYpek9BTlC4Bsq7uKquMX2Ex2',
    '7iSkOOlTw4PPqz5nmeogWY2FTcX2',
    'wrs3gTLjVxb6zHwyTm6iKvHRq4o1',
    'URo29oYSJ5auWIZvbEKPypSelSc2',
    'sj8ggn2175XpInnN76XLMdoKGIK2',
    '0YUxQ9k4tDglHrU5cQAxkA0QPp33',
    'KYYArxoOIsZz5BcplTfN4hpw3T23',
    'G1o0QFV0EeSOJS7W9QdYErBpXut1',
    'v0px40kW4Mb2iDHy1sBN2IuACou2',
    'fQjeMiHQQkMFBNslmjKqXOCq14U2',
    'bWC9CqzEsjavDpSGBchfhk9DGbD3',
    'kQh6jS3UUnbT9bNu2z2bep0jpAh1',
    'jEenZHNNcgZieO8Bgi7DJtXE5lu2',
    'seyww8tQtLSugmBgKRWbF4BLpPC3',
    'IVtufFf3nQMW343rL7TtF2sXntH3',
    'vQNQ3mpLqHX89cIkhau1IEDZ9it2',
    'XGPb970FwShGkMYgyqpCmUbP9Yu2',
    'uRCaxVoVYkfcN6X0iIEvIsUkXBn1',
    'xxwQnDMauXRdLRY3eeOz9GOYpm63',
    'FqicJ6vJSpQ7o3q5CAg28MDiMSD3',
    'aKNjnLLMNrQcAPaaK9Hu4U1LVLP2',
    'TecE9czVGtgSvVaCQPOvCmaQens1',
    'H5uN5CqxuXSWtLFWQKnA1UcTUhl1',
    'w6Dcoxsr89PF1tCjV4fr3QK870g2',
    'hKezqLEQMIgN5Vea6w7Z4BwQcNF3',
    'dmLkj0APMXR0jSPEVvQ2R8G3ikL2',
    '4vmDJlBV60cYH1L7vM4L1NF3zgJ2',
    '0FRAXXaBlWMRjeZZbIuqs9o3CzD2',
    'DGOX1RKZq4NGY4qztictlvOrukr2',
    'qUHJKqSbkHN2XFDuY8IbiAHCq1u2',
    'dOSs8da0LqZxqBNV520PJkm41Vm1',
    '4BfDr61Lpcf2NWtsoiK24hSn29Z2',
    'FuaqZt1n5Ab9a2WidTiYEmirCE63',
    '9X92bFAzkePJ5CbxCDaLi7o1xp82',
    'dwGaS3uJzZbfpk22Sbfegg51R8r1',
    'CRkZCMJEykSxZDnRczCc8ppSphz1',
    'FYyuZUtyBRabc2NsmvJEebbvhU63',
    't6Tol82UIjRhpdeXgnhAvWnR5Ax1',
    'sNPEIwTUHQg8wF3Cb1Trs99o3Ir2',
    'ymhInaAK51RsmsJ0kk8frjfXmQl2',
    'PnTqyPDZbZYEh2QxuPuvrBLLyDE2',
    'WVW5WKh8VbcCalUI8ILjQJMgCC13',
    'NkjM4X7SXTf53FZ6TF7mV8rOQgj1',
    'zzzxw4Bzx3T32AHmUE2syYxs4523',
    'MyyE991FkmXNaTFyK9knbybvzPh1',
    'EmjrUPaTWKO5XfIcQOXLU2Bz23t2',
    'lccB8gAzfGY4Bxl9Txpeu5NkcZI3',
    'RLY6Zv5cLGS78aOloOJVzUTc6yK2',
    '0tCN9YhQozLpBcP2HWc5woyUjZW2',
    'V9gJANsjH1dGcIBQBfXKSoPU9L23',
    'nJ5C2EbZutTW7oozMfuEJJawWeF2',
    'En59To2XyFQzQdAKRxD5IbSxYC23',
    '2s6NMoDOPdRwV9peQxdZJECHLlO2',
    'GRV7tUCNJaWlYz7ITMIjfQFFmRl1',
    'fQgNNqWvxyReyu4zd0JGRql08jh2',
    'K0sNABU5oQcI5D0h4AMgaVk6jOG2',
    'iWAVOyTXMEQFXBzpEdEQyGcpXiy1',
    'I6EZvvJB2dTfLrHIVs0Zds1lym02',
    'AsgimOq7rndt5StYAIyW746BpxB3',
    'zprIsV4uUQMpT2pXrr1b6fgtyvx1',
    'gfSopfUMWQSLtQrZLBB5ZeHhNCB3',
    'RleFuF0xQxafJ4Uee5T1yT46Wd42',
    'ig5O3ffygdf4W38FsAWzXb2BBrR2',
    '2UZnkrxC8GdYsW0xJlNXeR5VtAi1',
    'jGFaLevFdmTtPIfrrIhZ6kMIoR92',
    'SPk0v9b5K7UjCLoT77cSlbVWpqD3',
    'EUvhe7qxygWmsrehuMO6j4Iigim2',
    'SiU5UtO1jtbrj7Ny9qguyg4DIyA2',
    'duF8cRhe65Vv5meMwo2dZ2cBQnC2',
    '3r3cwvV7ozUEFbLkKvAamUUOHon1',
    'gJ5eDdMt5fOT923ueRe58KUdpfJ3',
    'mh9HciLnDLRO70iCgnYSGEOFOn83',
    '7Vu0zAY6afY6nJDN9QpmMiLzhMq1',
    '1MWmRlG44cfa2dXznd6uddGsuJm2',
    'SWVP46EAMceeLIe6Kxr3CbNJrOh1',
    'uWYR0fVXZtcCDkks3bsEAJyJY9v1',
    'SON0eUZxPGNeR2QrQtfQCPSAuwy1',
    'f1fiJiIbzOT8arTREd19ejXaQM33',
    '7RhYZZnbDfgTBtSW6OFIEGVSwGr2',
    'Cv2RldTjd9chX73f6wZOf5W1JoS2',
    'P9I3mFnbdahKHai1tREgiY9UNb92',
    'Fy2KIwgqH1aUe77ooNzyfBfxHkc2',
    '9FUNm7yWUMb8HQql3YVE6cMUXtK2',
    'fmYoYAvRnJNEPtjF2R3csFTDO8U2',
    '7l48uWHQWZVWkqLS5y60m4VhMu23',
    'sleF9v17y7baw5Cc5OoYTH3OlVa2',
    'b0MOldyTWaOfsscpIyKTj7kbeND2',
    '3eRyrOijYaNGPs4aNtdtqp1ZDNl1',
    'yR8tJ77B9ZPy9nZFBsROSrpXooF2',
    'EHUQNOuepuTUp7edo3hxXxeGzYL2',
    'Lu26AS8XQ1WDGJlFA5m7ZJGqcfG3',
    '4RUffa42NLXJXd1xAuJOgKcFr133',
    'ec3ngcqa8FU015LWqJl3Z7EkCro1',
    'cPaVn4F19JZwuzhEME1vu56a7eJ2',
    'pcEYwhEH2yTG5Rus1eoMdTAZCop1',
    'GeItQEhNFgPZ7Zmo42uwCaZngOA2',
    'Nf2VE5cDS3dPSLYKdkRTeLWwIY13',
    'r0EK4MVvGTRzgexL9IJ9M8Gnf462',
    'uTgeidsG9xVZA3ZbfqBMJt5Lsuf2',
    'Yum7v3VmI8SkpN2484yv78b3Zo62',
    'AcX7aJ8Wn1Ncf8y4o5pQSRgTKq82',
    'ebb7hWCiUSOaGF7rsxaxDe3TmSL2',
    'ITWeN0w9QeQ5M2w4BCvjoVuI0Ht2',
    'b7OYdjJatwTAfsOjRmYnZUU6qF82',
    '3usu2QbGOodB6nBQa0lQX3yi3qO2',
    'CCDvxDj5HvVDtxXY26PevdSGFfH2',
    'b6JQn60bW8bARXmjyyBJQNRAPf33',
    'oaTRpLXPhXSr9mCAAOYxmiiMmDn1',
    '7yhLnfAqN9fTFH6t56JdBOxIaAp1',
    'YVSOh5FVrsa8AIRB9HCvuKLniE03',
    '117fTSyIUkZK5Sa0PT8H7LepqSC3',
    'UydlyTpKu2NLCakey09JwSUVJbF2',
    'fSWPaZKIjfPHwmSN1t222nsWO3K3',
    'vUalNBIic6TnBZDXGRW8mHhBVI72',
    'nEJ7ybGgnCVSWGUjU3v4nXOqSKt1',
    'L2G8oi4G4ocFFrsQGXqzi7Hgy2n2',
    'OaYxAwY5NufAWg0aKbAXBPellcy1',
    'PRKNC0CgGvXnGoKBoxLu3tRuggJ2',
    '0Tex6V9nmjYeJitJppqJpbFlKQv2',
    'WGsEAN8cCbWspojJWZKaiXB8cbR2',
    'sn2mkt2JLrOjPK5ZG0gbVLDggmR2',
    'l5m568JDrDelcRCykqERH22OaJ43',
    'kdyac1l014QK5youBFJV57EjpIs2',
    'yahQi6gSeHasvC3AUiS51E0MeIi1',
    'fjviiOqYliX6UtBzlR310YHgCfQ2',
    'HjAypqkZOeY6TPaute7xf2TWom02',
    'rnolfGhmurSUvEnUEUYfFESYE7C2',
    'kgckC82musZDIAGEtdf2X2tRVme2',
    '2pOhwyuL6VUElysxe9rXoSoo5ZI2',
    'IMzKymtBHThrATkYGqDG81NRcho2',
    'nX66Zi3x7fM3EdrjgMid3SoMdnw1',
    'yL40vE98h7Uhtxxzvlg6eggK8WN2',
    '4t39fjsBfgfPRSZvH5QFY9sM7FD3',
    'Jxw4BQXl2RU0TQXZSjw4Bqp0tp23',
    'juWt6rMIdeNAUak7tITTAEQumDG3',
    'bUdqWF79bgRmDVTa1PEL4KoMb4Q2',
    '9QhpkJpU9kURrmzZw5dhQNp87Am1',
    'zIKEmWhYnxZY1W0jduW23Ju7N6c2',
    'ORs7IWC0KTZhRTp0wOSPhCvWk6G2',
    'YmVHUZbU49ROrLx8CyFU6juIkvG3',
    'MpiWOZADxtaKM4IGineDoNb2GQ12',
    'hHV2Dl9ussUMTHVoztORNYuGtDe2',
    'CEv8yCYixxTvjlLSiDRXWGMr9C52',
    'MIE95oRPx1S6f5vQokmhr7Cq97v2',
    'ps1ls8PgkidFRGJdjfCpboFCPJu1',
    '7klkWVDgULQrWKbVOU0KKxKYrRG2',
    'j9GnK8qvO7ZhTqpU43QIHhMdRGJ3',
    'IFwRi0tdw9ZoHaufZPNN6j4mnCJ3',
    'W8LteQm6SGXay5LYDTePR2c7FO23',
    'bcRzA6S4XoU7GlsPxCMbfCx213F2',
    'G557Dg0jWwVt9aqtLxvvzhBEFd52',
    'FucTbFzJjLSSmvgH65teBF7Hot73',
    'nJ2LqRUIgrgFZWzZXedUMP8D1sG2',
    'pJ97IUr8mkersPFO5WKA7jNhvIZ2',
    '7vkAPbdayTSL1Ubx7EU1uOahvaL2',
    'GXJM7DF8H5QLOpPKTgYf4GfdRxD2',
    'IW0G0njDNiSvXlfasG8ns5MCLmi2',
    'IXA81vQZzCPPvxQoglBwyftAcAH3',
    'EiknN2IRHYPaI0Ag3VphnVHA7Tm2',
    'KDcE7tTW9GUUmXMQhC5H0LdP2U23',
    'LMQk6Lry0xcmMRnI7kkzFFSYipb2',
    'EUfa8mZ8TOhzEghfaJGYtrEJCh92',
    'UmcNCHWHc7bWNrW3zCvg9wQaoAZ2',
    'dhhg4IOCc2SQDDdAPQRIgauwsL22',
    'lY10h0FlVwbXpa0Q9U7nxuS1wEw1',
    'nkIkTQ0lKPRrSOB2J323WjXDkMI2',
    'o3WchFx05aQYqIqKGPFDJ67jiig2',
    'Ztjpl3RTBlW1fxixqrQq3B2arkA2',
    'mLMZb26cVHR9uWhI8Pfo0rsxTjO2',
    'V8U1L1KrCdb9G5RDwS2gC1TXfwu2',
    'oM0KqTCT8MSPhNXWicOVTSNRap42',
    'F5RiDNVQsLbI9euqVB7jyfoL98J2',
    'XzUfBGWlNuR4KuzgFV8MCHiG6GF2',
    '3BURVlP8FZfaAsjUtar5hu2UsKE2',
    '9NkE7V31M5ap9U9LDVMmKjmQZn83',
    'RJjKdHd0aYMfTVYKKeZwwjvkmJt2',
    'aHhULOAQ5bPMOkNfhzC0AcSFBzi2',
    'aHmqqsDAkrdAZALAPs1xlzDWFSg2',
    'I0RXr9v0J3XvWsilp4Fe5AZCK0J2',
    'UPvsGn1SwMMKKkXalJx3mWvGepC3',
    'bxTnkph7rFQoRMiwvweQcLkiCjQ2',
    'hbFoJft5xkWnknsP5y9rL4Lrbdu2',
    'rQuwUfiDWJhzWrCeFfN7MBcQPEl2',
    '8OKkKWO3LigHxDaMYxYJp9uijds1',
    'WxBGXrA5DibesSKGgSmWLTSvVTX2',
    'eqipdqaLYuN6KmxfSDT7AkwAaIo1',
    'vU9zpdcROkQmFn86SQsAsbeFKof1',
    '6fURpvKNwMMCbZNyAshV7mSLRTD3',
    'KAL4gdGV8xSKYy1xoW8zzc6lCSH3',
    '5THwyb7yiYXUfR2y435Hl2HeObR2',
    '8XWQfGldsFTG5v24Ezf05OkoUb73',
    'eBkGYmQdYhcORil6h4jfm3LTd3I3',
    'oWAO98RHKddgT0GNHy5hPd2GbsK2',
    'JNrweSJuOuh2YcVgIRfPvwvmmME3',
    'fIicg5OjCOdm24FDRCIhPmqO9Lu2',
    'nNwvAgS9KbO5mhuXFPcCb1nYgmm1',
    'Tnqaee3BmBY3UuDh78PqBM667Hg2',
    'z611w7f3xQToksPqcHrk260A8Fh1',
    'CRxw66N05HStiW7ceIht70WEoc03',
    'UprZ7TYYAoe4HLBHxC8B6GfKIgm2',
    'nTcFTsVtgSSbSej1mvwzhgS5Yjf1',
    'HtRmA0UDPXh5yeiRN0P6DHJF8St2',
    'AbJtdBJNM9bnlYcqHmA3Q9yqYHZ2',
    'BJpYRsOaljVuw9oqz9FG6H10aJe2',
    'Zvq880oO13QswgF5RVg6QZZdQr32',
    '4eQ0UIsHLiRf3oxH6eVvxgcF2xg1',
    'nCrBl1FLbzWEVHsoReJpgqJzfrF2',
    'uXnc0GUFoMcQVcBghQAvpQpjidt2',
    'frKy6AtJg0WfABhfri9cyTM6ved2',
    '2qxVdkTvNSVhU92M8rxizKLDjsj1',
    'YzogPS8jpFS9PwCMmUNmKkmDp212',
    '63gtLvvKzCONW0RxKLz0yRYGQId2',
    'ADXOl1vdzOY44ysSwn71UsMyCsl1',
    'pqvVsexTpqZU7PohhivWxOo3n7v1',
    'BUTNsTjs2qU0O3CmfstGuwjPijx2',
    'JYYusa8GrQXBh6ynmYNps6QL9712',
    'O7zmEiNDBdZzNaWyl1vX0eDdrYv2',
    'NhGwOUlG83RSAF8nIj5KfK52wkx2',
    '0NX2tfkwxwZRZVdVJfXAV5BCYq72',
    '6BbQMzrCP5dRLucyM51EBgl9G0h2',
    'JWF9C9xR6QhaGw0TRe22OupiAIc2',
    'yCh6Xf0TsebnU0GI9ZCrCvXnoLK2',
    'QboyoW1gXXQMA1u7zM1ldw04Zu33',
    'HEbpDvGnFihpoKcvCwI1uchKPz32',
    'RZjrkwgScOdpNC4YzEpNZaklME52',
    'op7BRnCnYtWvSEGDaR4Lxqxp8ur1',
    'rnoQ3SopVkSeA8p6CATZPhGCgM93',
    'HyLCWjY5nAO6GoLOmUUt005mMrQ2',
    'yZvGQQBoHdUN2S9IZdWblga8K112',
    'woOPhLRarGehmSmLEK6dO7eR8wo1',
    'zMzYjJ1YcPM2ZOAo62blPbCjy4r2',
    'zrnDTPOvDjc6Hcx7GHNkcsEYcsU2',
    'i14EbR1dxxfpgLrKioVRWpX57nq1',
    's4EKQVAwuXWWDmcUSGtD9a58sYh2',
    'HEKu0F6mJMh9VgM1ZYKfJUuX2ax1',
    'BHacTszP7IVgfOWRQVMS66ZrgTA2',
    'YDJAFIUUBJc3knclIaRCerOtzGS2',
    'aWEKv3ItZ7SyPwpE0K5b1Sofh5F3',
    'llTr8And0ufEolOo6vryoCYewLE2',
    '01oiengrDwgtPowfSs8Nw6JozPG3',
    '1RFSx0rqIDeTUOjWmdNaRAmtW8L2',
    'AcQCN8kJcMU2WoUm0rzXcfUsJ4D2',
    'IT8vSdFvzshdIEb5tA9YP1Orx2F2',
    'PmgXLQZdxDeByt4msjnl0sICcnl2',
    'YBRxKBJsV6QfkvU06EyDMIbjaXd2',
    'f8p8cIV9Dechyw8wMexkklPyyZs1',
    '2m9Kwnf3hSTQGmvxPIsEw7RXftr2',
    '5FkN655E4xTETMu4N1eb3DhakK92',
    'Gi92TsCcabO6QeposXQxNGkDwnV2',
    'gjgJYA9d6vfObTZtfo9NfakybRC2',
    'Xr5PVgvjVVMxOjaziZ83Yi0tOl53',
    'Z7aaXzEuyrVa71f1qDsM3Bd5NVz2',
    'xvKSMLdUGDZHqbkoiC95lcz5sRH3',
    'U4QrOkvFrfNENovF6vaPr3QNZbp2',
    'YJMOZKknKgfjWJ106P76jaeyEUK2',
    'fR0SRWTdnNQJjQRLGfh270bO4zI2',
    'm3SlF7pGFbexHEHphLSEvz0kfi32',
    'oWQLSXzzlIa1BtFnBt4Hg3FCCEZ2',
    's9sxYxjkppbTPYE4igb4xiWP1dO2',
    '79DI0kCa1cUZsHEFVKjBDUOdRwJ3',
    'EFOQEAhomFP5IwUr63POgLcVKyb2',
    'tiFTCcJcrTgCXurX4HJKeSC6ezD3',
    'Z2syuLtOlOMndZE2Tk6WNWWqcBM2',
    '2za7AOdILRbzMClLj2a4Wjb0tGh2',
    'U8THKbCS26UAdsfGcwx3zNCURDt1',
    'UvNmVRQ6daSWRkkByft42dFkLUO2',
    'CIgkOqKayPhonl0aPXLqKz1qNs93',
    'YlC624X2FUXIVOcIN2YD7KAkBk42',
    '6ITD57lxQScfU3oUs1yVug3P7ep2',
    'nJgfUF9uE8VIGj1GcvUfpvhtNyp1',
    'WvmQNkdaA4OhemWOy6mFtAksrhQ2',
    'BjjTYnFpH7af9d0Yycay4sNnI182',
    'ZfrEYbcpvjYiSA7Z7YvEDmrUQb02',
    'Jw7LgJxlE6cDudCuC7WW29U66Hg1',
    'uikcIRGGjgV6dWO0RrTogPBkeh83',
    'Jt9zg32PRIbz5UgDPh4NEh7gQCx2',
    '9L78JJe6VbXEJ0TvNSLcIBTIWJj2',
    'DmhI43HNHSM9wobIbVhbqXvmQPT2',
    'UMhk7L9OdQPKxYcgRX1P1mNljZJ2',
    'JMh57TnEXSXe5r0clcyD5dr9PGB3',
    'cN2m4g553MWcyPPLfoprfLSIwPx1',
    'uKWfblevvzM14yOJq1EMsp0nIFJ3',
    'vhdS5AUNMcfnhPArKvPjlq3EGPm2',
    'MrHuWKrKtbWAGqCp8UNhrq5mTrm1',
    'EkD16hykvKT55fLtFGxmK1Mr1Ew2',
    'YolxPOJVuMTsE0ffbETDAbESdun1',
    'rRYJ5Ar33HVEskcwPeLOO1vyb602',
    'yD2mWd214laCvDIZOY7bn1VYXfC2',
    'eTrJbUWXZdQw3lWKeYBrQ1gvQuH3',
    'MyGif6mGBvbZQLwS7dte5d3ZHez2',
    'x1f65hGDioRTKyI1e7tGPvYM3a92',
    '7PxoJNX1UCPaT3msFfXtBwuT0zo2',
    'Eb4FaSjBOPP5JMQh8KteiXKepsp2',
    'M1On87xjYRNKsDEVpuoBomiyI0H2',
    'WDmsflJ7Kac6fYAfDUfh5fL76r02',
    'pncNUNoqygMXhQOiIQggwCsBGy82',
    '1bIrGpp3QHSiRzfeSpaVoR6x7Ux1',
    'FqGsBd34USRDt4gJA7P2FdDsIwl1',
    '8XOi6P3Hp4ckRQP0VUy7cojrpA03',
    'JA4uqL39GGOXP8XYQzwRjx3JaL52',
    'VBgFCyo9Nggs2olKjkeJcg4T6Dy1',
    'nTksflePLvbffWjhCYp1RUPvb6w1',
    'CbDfT7PxKlepFYU11u35bCqYVJj1',
    'kuZoT7Fz5HUmWe8N58AiGhPo2Z93',
    'CVHrjjCyPMY9W5j7DkrHTVFTrV63',
    'MiBeNmrgZLaPOtwlu0z5EMdcALT2',
    'NhjcJEr8uWfsqCGj5nqJntJiuQN2',
    'OaJDKhHAXaREhWbTQ90p9oeqLZ93',
    'BHg8o5AtvTXTa2zPL8C9UeVWEF02',
    'V8aFYzx8nbZqjbK7GT7Sp2Apac52',
    'pHJULMEhdZNQ0ywHFOvuZeBPCdY2',
    'AOXb2YqGVgT1WkqM1dWsht8Zov42',
    'eU39t8CFVWXPjn0iW2HLnTHZRFz1',
    'xTtTVvPkEEXSwitLd2LtRIo8D753',


]

async function getcsv(list){
    let data = []
    for(userid of list){
        try {
            console.log('userid -> ' , userid)
            let res = await database.collection('UserDetails').aggregate([
                {
                    $match : {
                        userid : userid
                    }
                }
            ]).toArray()
            let details = res[0]
            // console.log('details -> ', res)
            res = await database.collection('UserStats').aggregate([
                {
                    $match : {
                        userid : userid
                    }
                }
            ]).toArray()
            // console.log('res -> ', res)
    
            details.rating = res[0].rating
            data.push(details)
        } catch (error) {
            console.log('ERROR : ' , error)
        }
    }

    const csv = Papa.unparse(data);
    return csv
}

async function main(){
    const {useridsbefore , useridsduring} = await getUserIds()

    let csvbefore =await getcsv(useridsbefore)
    fs.writeFileSync('./csvs/before.csv', csvbefore);
    let csvduring =await getcsv(useridsduring)
    fs.writeFileSync('./csvs/during.csv', csvduring);
    
    process.exit(0)
}

main()